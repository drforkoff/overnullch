{"version":3,"sources":["../../babel/src/catalog.js"],"names":["main","$","ajaxSetup","dataType","click","toggleClass","fetchPromises","Promise","resolve","reject","getJSON","Date","getTime","done","catalog","add","data","chans","origin","version","fail","err","localStorage","myDrafts","JSON","parse","myDraftsRaw","_","cloneDeep","e","removeItem","console","error","push","myDraftsValid","forEach","draft","name","url","id","match","originalID","errorBoy","pushError","all","then","list","init","bind","ev","$chev","parent","find","css","stopPropagation","addClass","tab","text","toLowerCase","switchTab","ctab","focus","on","val","trim","length","injector","inject","removeClass","$ch","parents","toggle","_libdata","preventDefault","handleFile","originalEvent","jq","msg","append","escape","vers","versMap","v","versions","stringify","sortable","Sortable","create","document","querySelector","handle","animation","onSort","sync","myList","myListUpdated","actual","chanByID","ich","each","arrayify","chan","prop","buildChan","ballSrc","ball","section","_id","ballv","includes","toArray","remove","res","querySelectorAll","ch","default","insertAfter","wiki","conf","search","replace","included","makeGradient","catbg","offset","makeOffset","location","protocol","host","syncRawDrafts","arr","Array","alias","existing","getElementById","innerHTML","head","getElementsByTagName","style","createElement","type","styleSheet","cssText","appendChild","createTextNode","removeChild","colors","unprefixed","exec","rest","without","gradientDirection","ret","gradientType","isNaN","parseFloat","gradientStops","prefix","left","top","NodeList","prototype","makeEscapeTagLiteralFn","fn","strings","result","i","reloadFrame","frames","reload","openMenu","window","addEventListener","live","files","dataTransfer","target","f","reader","FileReader","onload","imported","readAsText","info"],"mappings":"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","file":"catalog.js","sourcesContent":["\"use strict\";\r\n\r\nconst main = () => {\r\n\t$.ajaxSetup({\r\n\t\tdataType: 'json'\r\n\t})\r\n\r\n\t$('#drawer, #hijab').click(() => $('body').toggleClass('list-collapsed'))\r\n\r\n\tlet fetchPromises = [new Promise((resolve, reject) => {\r\n\t\t$.getJSON(`/chans/chans.json?v=${new Date().getTime()}`)\r\n\t\t.done(data => {\r\n\t\t\tcatalog.add(data.chans)\r\n\t\t\tresolve({\r\n\t\t\t\torigin: 'server',\r\n\t\t\t\tversion: data.version\r\n\t\t\t})\r\n\t\t})\r\n\t\t.fail(err => reject(err))\r\n\t})]\r\n\tif (localStorage['mydrafts']) {\r\n\t\tlet myDrafts = null\r\n\t\ttry {\r\n\t\t\tmyDrafts = JSON.parse(localStorage['mydrafts'])\r\n\t\t\tcatalog.myDraftsRaw = _.cloneDeep(myDrafts.chans)\r\n\t\t}\r\n\t\tcatch(e) {\r\n\t\t\tlocalStorage.removeItem('mydrafts')\r\n\t\t\tconsole.error(e)\r\n\t\t}\r\n\t\tif (myDrafts.chans) {\r\n\t\t\tfetchPromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\tlet myDraftsValid = []\r\n\t\t\t\tmyDrafts.chans.forEach(draft => {\r\n\t\t\t\t\tif (draft.name && draft.url && draft.id && draft.id.match(/^[a-z\\-_0-9]+$/)) {\r\n\t\t\t\t\t\tdraft.originalID = draft.id\r\n\t\t\t\t\t\tdraft.id += `!draft`\r\n\t\t\t\t\t\tmyDraftsValid.push(draft)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\terrorBoy.pushError(`Черновик #${draft.id} не добавлен в каталог: недостаточно данных или некорректный ID.`)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tcatalog.add(myDraftsValid, 'drafts')\r\n\t\t\t\tresolve({\r\n\t\t\t\t\torigin: 'drafts',\r\n\t\t\t\t\tversion: myDrafts.version\r\n\t\t\t\t})\r\n\t\t\t}))\r\n\t\t}\r\n\t}\r\n\tPromise.all(fetchPromises).then(list.init.bind(list), err => console.error(err))\r\n\r\n\t$('.tab').click(function(ev) {\r\n\t\tlet $chev = $(this).parent().find('.icon')\r\n\t\tif ($chev.css('display') === 'block' && $chev.css('opacity') == 1) {\r\n\t\t\tev.stopPropagation()\r\n\t\t\t$('#catalog header').addClass('tab-selecting')\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet tab = $(this).text().toLowerCase()\r\n\t\t\tswitchTab(tab)\r\n\t\t}\r\n\t})\r\n\r\n\tlet ctab = localStorage['cat-tab']\r\n\tif (ctab) {\r\n\t\tswitchTab(ctab)\r\n\t}\r\n\r\n\t$('#toggle-search').click(function() {\r\n\t\t$('#catalog').addClass('searching')\r\n\t\t$('#search').focus()\r\n\t})\r\n\t$('#search').on('input', function() {\r\n\t\tlet val = $(this).val().trim().toLowerCase()\r\n\t\t$('#catalog').toggleClass('search-filter', !!val.length)\r\n\t\tinjector.inject('cat-search', `.search-filter .cat-chan[data-search *= \"${val}\"] {display: inline-block}`)\r\n\t})\r\n\t$('#cancel-search').click(function() {\r\n\t\t$('#catalog').removeClass('searching search-filter')\r\n\t\t$('#search').val('')\r\n\t})\r\n\r\n\t$('body')\r\n\t.click(() => $('#catalog header').removeClass('tab-selecting'))\r\n\t.on('click', '.cc-install', function() {\r\n\t\tlet $ch = $(this).parents('.cat-chan')\r\n\t\tlist.toggle($ch[0]._libdata)\r\n\t})\r\n\t.on('click', '.make-embed', function() {\r\n\t\t$(this).parents('.cat-chan').toggleClass('code-on')\r\n\t})\r\n\t.on('dragenter dragend dragover drop dragleave', function(ev) {\r\n\t\tev.preventDefault()\r\n\t\tev.stopPropagation()\r\n\t})\r\n\t.on('drop', ev => handleFile(ev.originalEvent))\r\n\r\n\t$('#up-victim').on('change', ev => handleFile(ev.originalEvent))\r\n\t$('#import-draft').click(() => $('#up-victim').click())\r\n}\r\n\r\nfunction switchTab(tab) {\r\n\t$('.tab').removeClass('tab-selected')\r\n\t$(jq`#tab-${tab}`).addClass('tab-selected')\r\n\t$('#catalog').removeClass('tab-default tab-custom tab-drafts').addClass(`tab-${tab}`)\r\n\tlocalStorage['cat-tab'] = tab\r\n}\r\n\r\n/*function displayErrorToggle(text) {\r\n\t$('#errmsgbox').fadeToggle('fast').find('.error-message').text(text || '')\r\n}*/\r\n\r\nvar errorBoy = {\r\n\tpushError: function(msg) {\r\n\t\t$('#error-wrapper').append(html`<div class=\"errmsgbox\" onclick=\"this.remove()\">\r\n\t\t\t<svg id=\"close-errmsg\" class=\"icon\"><use xlink:href=\"#i-x\"></use></svg>\r\n\t\t\t<p class=\"error-message\">${_.escape(msg)}</p>\r\n\t\t</div>`)\r\n\t}\r\n}\r\n\r\nvar list = {\r\n\tinit: function(vers) {\r\n\t\tlet versMap = {}\r\n\t\tvers.forEach(v => versMap[v.origin] = v.origin)\r\n\t\tthis.versions = versMap\r\n\t\tlocalStorage['catalogVersions'] = JSON.stringify(versMap)\r\n\r\n\t\tthis.sortable = Sortable.create(document.querySelector('#boardlist'), {\r\n\t\t\thandle: '.dragger',\r\n\t\t\tanimation: 150,\r\n\t\t\tonSort: this.sync.bind(this)\r\n\t\t})\r\n\t\t\r\n\t\tlet myList = localStorage['myChans_new']\r\n\t\t, myListUpdated = []\r\n\t\tif (myList) {\r\n\t\t\ttry {\r\n\t\t\t\tmyList = JSON.parse(myList)\r\n\t\t\t}\r\n\t\t\tcatch(e) {\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t\tlocalStorage.removeItem('myChans_new')\r\n\t\t\t\tmyList = null\r\n\t\t\t}\r\n\t\t\tif (myList && myList.length) {\r\n\t\t\t\tmyList.forEach(ich => {\r\n\t\t\t\t\tlet actual = catalog.chanByID(ich.id)\r\n\t\t\t\t\tif (actual) {\r\n\t\t\t\t\t\tmyListUpdated.push(actual)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!myList) {\r\n\t\t\t$('.included-chan').each(function() {\r\n\t\t\t\tmyListUpdated.push(this._libdata)\r\n\t\t\t})\r\n\t\t}\r\n\t\tthis.add(myListUpdated)\r\n\t},\r\n\tadd: function(chans) {\r\n\t\tarrayify(chans).forEach(chan => {\r\n\t\t\t['catbg', 'offset'/*, 'included'*/].forEach(prop => delete chan[prop])\r\n\t\t\tlet $ch = $(this.buildChan(chan))\r\n\t\t\t$ch[0]._libdata = chan\r\n\t\t\t$('#boardlist').append($ch)\r\n\t\t\t$(jq`#cat_${chan.id}`).addClass('installed')\r\n\t\t})\r\n\t\tthis.sync()\r\n\t},\r\n\tbuildChan: function(chan) {\r\n\t\tlet name = _.escape(chan.name)\r\n\t\t, ballSrc = chan.ball || html`/chans/balls/${chan.section}/${chan.section == 'drafts' ? 'no-ball' : chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}`\r\n\t\treturn html`<li class=\"list-chan\" id=\"installed_${chan.id}\" data-id=\"${chan.id}\">\r\n\t\t\t<img src=\"${ballSrc}\" class=\"list-chanball\">\r\n\t\t\t<div class=\"dragger\"><svg class=\"icon\"><use xlink:href=\"#i-drag\"></use></div>\r\n\t\t\t<div class=\"list-chan-title\">${name || 'Без имени'}</div>\r\n\t\t\t<div class=\"delete-chan\" onclick=\"javascript:list.remove('${chan.id}')\"><svg class=\"icon\"><use xlink:href=\"#i-x\"></use></div>\r\n\t\t</li>`\r\n\t},\r\n\ttoggle: function(chan) {\r\n\t\tif (_.includes(this.sortable.toArray(), chan.id)) {\r\n\t\t\tthis.remove(chan.id)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.add(chan)\r\n\t\t}\r\n\t},\r\n\tremove: function(id) {\r\n\t\t$(jq`#installed_${id}`).remove()\r\n\t\t$(jq`#cat_${id}`).removeClass('installed')\r\n\t\tthis.sync()\r\n\t},\r\n\tsync: function() {\r\n\t\tlet res = []\r\n\t\tdocument.querySelectorAll('.list-chan').forEach(ch => {\r\n\t\t\tres.push(ch._libdata)\r\n\t\t})\r\n\t\tlocalStorage.removeItem('compiledCSS')\r\n\t\tlocalStorage['myChans_new'] = JSON.stringify(res)\r\n\t}\r\n}\r\n\r\nvar catalog = {\r\n\tadd: function(chans, section) {\r\n\t\tarrayify(chans).forEach(chan => {\r\n\t\t\tif (!chan.section) {\r\n\t\t\t\tchan.section = section || (chan.default ? 'default' : 'custom')\r\n\t\t\t}\r\n\t\t\tchan.url = _.escape(chan.url)\r\n\t\t\tlet $ch = $(this.buildChan(chan))\r\n\t\t\t$ch[0]._libdata = chan\r\n\t\t\t$('#catalog-contents').append($ch)\r\n\t\t})\r\n\t\t$('#import-draft').insertAfter('.cat-chan:last')\r\n\t},\r\n\tbuildChan: function(chan) {\r\n\t\tlet name = _.escape(chan.name)\r\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\r\n\t\t, search = `${chan.originalID || chan.id} ${name} ${chan.url.replace(/^https?:\\/\\//, '')} ${(chan.wiki || '').replace(/^https?:\\/\\//, '')}`\r\n\t\t, ballSrc = chan.ball || `/chans/balls/${chan.section}/${chan.section == 'drafts' ? 'no-ball' : chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}`\r\n\t\treturn html`<div class=\"cat-chan sect-${chan.section} ${chan.included ? 'included-chan' : ''}\" data-search=\"${search.toLowerCase()}\" id=\"cat_${chan.id}\">\r\n\t\t\t<div class=\"cc-ball-wrap\" style=\"${makeGradient(chan.catbg)}\">\r\n\t\t\t\t<img src=\"${ballSrc}\" class=\"cc-ball\" ${chan.offset ? makeOffset(chan.offset) : ''}></img>\r\n\t\t\t\t<div class=\"channame-overlay\">\r\n\t\t\t\t\t<a href=\"${chan.url}\">${name}</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"cc-toolbar\">\r\n\t\t\t\t<button class=\"cc-install\">\r\n\t\t\t\t\t<span class=\"cci-i\">Добавить</span>\r\n\t\t\t\t\t<span class=\"cci-u\">Удалить</span>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"chan-options make-embed\" title=\"Код для кнопки\">\r\n\t\t\t\t<svg class=\"icon\">\r\n\t\t\t\t\t<use class=\"co-code\" xlink:href=\"#i-code\"></use>\r\n\t\t\t\t\t<use class=\"co-close\" xlink:href=\"#i-x\"></use>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t\t<a class=\"chan-options info-link\" target=\"_blank\" href=\"${wiki}\" title=\"Информация\">\r\n\t\t\t\t<svg class=\"icon\"><use xlink:href=\"#i-info\"></use></svg>\r\n\t\t\t</a>\r\n\t\t\t<textarea onclick=\"this.select()\">${_.escape(`<script src=\"${document.location.origin || (document.location.protocol + '//' + document.location.host)}/embed/add.js\" chan=\"${chan.id}\"></script>`)}</textarea>\r\n\t\t</div>`\r\n\t},\r\n\tchanByID: id => {\r\n\t\tlet ch = document.querySelector(jq`#cat_${id}`)\r\n\t\tif (ch && ch._libdata) {\r\n\t\t\treturn ch._libdata\r\n\t\t}\r\n\t\telse return null\r\n\t},\r\n\tmyDraftsRaw: [],\r\n\tsyncRawDrafts: function() {\r\n\t\tlocalStorage['mydrafts'] = JSON.stringify({\r\n\t\t\tversion: new Date().getTime(),\r\n\t\t\tchans: this.myDraftsRaw\r\n\t\t})\r\n\t}\r\n}\r\n\r\nfunction arrayify(arr) {\r\n\treturn (arr instanceof Array) ? arr : [arr]\r\n}\r\n\r\nvar injector = {\r\n\tinject: function(alias, css) {\r\n\t\tvar id = `injector:${alias}`\r\n\t\tvar existing = document.getElementById(id)\r\n\t\tif (existing) {\r\n\t\t\texisting.innerHTML = css\r\n\t\t\treturn\r\n\t\t}\r\n\t\tvar head = document.head || document.getElementsByTagName('head')[0]\r\n\t\t, style = document.createElement('style');\r\n\t\tstyle.type = 'text/css'\r\n\t\tstyle.id = id\r\n\t\tif (style.styleSheet) {\r\n\t\t\tstyle.styleSheet.cssText = css\r\n\t\t} else {\r\n\t\t\tstyle.appendChild(document.createTextNode(css))\r\n\t\t}\r\n\t\thead.appendChild(style)\r\n\t},\r\n\tremove: function(alias) {\r\n\t\tvar id = `injector:${alias}`\r\n\t\tvar style = document.getElementById(id)\r\n\t\tif (style) {\r\n\t\t\tvar head = document.head || document.getElementsByTagName('head')[0]\r\n\t\t\tif (head)\r\n\t\t\t\thead.removeChild(document.getElementById(id))\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction makeGradient(colors) {\r\n\tlet unprefixed = `linear-gradient(to bottom, #${colors[0]} 0%, #${colors[1]} 100%)`\r\n\t, res = /(((?:radial|linear)-gradient)\\((?:(ellipse) at center|(-?[0-9]+)deg|to (right|bottom)), ?(.+)\\));?/i.exec(unprefixed);\r\n\tif (res === null) return 'background:' + unprefixed;\r\n\tres = _.rest(_.without(res, undefined));\r\n\tvar ret = res[0]+'; ';\r\n\tvar gradientType = res[1];\r\n\tvar gradientDirection;\r\n\tif (!isNaN(res[2])) gradientDirection = (90 - parseFloat(res[2])) + 'deg, ';\r\n\telse if (res[2] == 'bottom') gradientDirection = 'top, ';\r\n\telse if (res[2] == 'right') gradientDirection = 'left, ';\r\n\telse gradientDirection = 'center, ellipse cover, ';\r\n\tvar gradientStops = res[3];\r\n\t_.each(['-o-', '-webkit-', '-moz-'], function(prefix) {\r\n\t\tret += 'background:' + prefix + gradientType + '(' + gradientDirection + gradientStops + '); ';\r\n\t});\r\n\treturn 'background:' + ret;\r\n}\r\n\r\nfunction makeOffset(offset) {\r\n\tlet left = offset[0], top = offset[1]\r\n\t, ret = ''\r\n\tif (left == 0 && top == 0) {\r\n\t\treturn ret\r\n\t}\r\n\t;['', '-webkit-', '-ms-', '-moz-', '-o-'].forEach(prefix => {\r\n\t\tret += `${prefix}transform: translate(${left}px, ${top}px); `\r\n\t})\r\n\treturn `style=\"${ret}\"`\r\n}\r\n\r\nNodeList.prototype.forEach = Array.prototype.forEach;\r\n\r\n// Produces a function which applies fn() to all values\r\nfunction makeEscapeTagLiteralFn(fn) {\r\n  return function(strings, ...values) {\r\n    let result = \"\"\r\n    for (let i = 0; i < strings.length; i++) {\r\n      result += strings[i]\r\n      if (i < values.length) {\r\n        result += fn(values[i])\r\n      }\r\n    }\r\n    return result\r\n  }\r\n}\r\n// Escape tag literal functions for jQuery queries and regular expressions\r\nvar jq = makeEscapeTagLiteralFn(v => v.replace(/([!\"#$%&'()*+,\\-./:;<=>?@[\\\\\\]^`{|}~ ])/g, \"\\\\$1\"))\r\n\r\nvar conf = {\r\n\twiki: 'http://wiki.1chan.ca/'\r\n}\r\n\r\nfunction reloadFrame() {\r\n\tparent.frames.list.document.location.reload()\r\n\tparent.openMenu()\r\n}\r\n\r\nwindow.addEventListener(\"message\", () => {\r\n\tparent.frames.live.document.location.reload()\r\n}, false)\r\n\r\nfunction handleFile(ev) {\r\n\tlet files = (ev.type == \"drop\") ? ev.dataTransfer.files : ev.target.files\r\n\t, f = files[0]\r\n\r\n\tif (f) {\r\n\t\tvar reader = new FileReader()\r\n\t\t\r\n\t\treader.onload = (function() {\r\n\t\t\treturn (function(e) {\r\n\t\t\t\tlet imported = null\r\n\t\t\t\ttry {\r\n\t\t\t\t\timported = JSON.parse(e.target.result)\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\terrorBoy.pushError('Не удалось разобрать JSON')\r\n\t\t\t\t}\r\n\t\t\t\tif (imported) {\r\n\t\t\t\t\tif (!(imported.name && imported.url && imported.id && imported.id.match(/^[a-z\\-_0-9]+$/))) {\r\n\t\t\t\t\t\terrorBoy.pushError('Невозможно добавить черновик. Недостаточно данных.')\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_.find(catalog.myDraftsRaw, {id: imported.id})) {\r\n\t\t\t\t\t\terrorBoy.pushError('Черновик с таким id уже существует')\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatalog.myDraftsRaw.push(_.cloneDeep(imported))\r\n\t\t\t\t\tcatalog.syncRawDrafts()\r\n\t\t\t\t\timported.id += `!draft`\r\n\t\t\t\t\tcatalog.add(imported, 'drafts')\r\n\t\t\t\t}\r\n\t\t\t}).bind(this)\r\n\t\t}).bind(this)(f)\r\n\r\n\t\treader.readAsText(f)\r\n\t}\r\n}\r\n\r\nconsole.info('Я не на ангуляре. Не на ангуляре.')"]}