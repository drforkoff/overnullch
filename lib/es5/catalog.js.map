{"version":3,"sources":["../../babel/src/catalog.js"],"names":["main","$","ajaxSetup","dataType","click","toggleClass","fetchPromises","Promise","resolve","reject","getJSON","Date","getTime","done","catalog","add","data","chans","origin","version","fail","err","localStorage","myDrafts","JSON","parse","myDraftsRaw","_","cloneDeep","e","removeItem","console","error","push","myDraftsValid","forEach","draft","name","url","id","match","originalID","errorBoy","pushError","all","then","list","init","bind","ev","$chev","parent","find","css","stopPropagation","addClass","tab","text","toLowerCase","switchTab","ctab","focus","on","val","trim","length","injector","inject","removeClass","$ch","parents","toggle","_libdata","preventDefault","handleFile","originalEvent","jq","msg","append","html","escape","vers","versMap","v","versions","stringify","sortable","Sortable","create","document","querySelector","handle","animation","onSort","sync","myList","myListUpdated","actual","chanByID","ich","each","arrayify","chan","prop","buildChan","ballSrc","ball","section","_id","ballv","includes","toArray","remove","res","querySelectorAll","ch","default","insertAfter","wiki","conf","search","replace","included","makeGradient","catbg","offset","makeOffset","location","protocol","host","syncRawDrafts","arr","Array","alias","existing","getElementById","innerHTML","head","getElementsByTagName","style","createElement","type","styleSheet","cssText","appendChild","createTextNode","removeChild","colors","unprefixed","exec","rest","without","gradientDirection","ret","gradientType","isNaN","parseFloat","gradientStops","prefix","left","top","NodeList","prototype","makeEscapeTagLiteralFn","fn","strings","result","i","reloadFrame","frames","reload","openMenu","window","addEventListener","live","files","dataTransfer","target","f","reader","FileReader","onload","imported","readAsText","info"],"mappings":"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","file":"catalog.js","sourcesContent":["\"use strict\";\r\n\r\nconst main = () => {\r\n\t$.ajaxSetup({\r\n\t\tdataType: 'json'\r\n\t})\r\n\r\n\t$('#drawer, #hijab').click(() => $('body').toggleClass('list-collapsed'))\r\n\r\n\tlet fetchPromises = [new Promise((resolve, reject) => {\r\n\t\t$.getJSON(`/chans/chans.json?v=${new Date().getTime()}`)\r\n\t\t.done(data => {\r\n\t\t\tcatalog.add(data.chans)\r\n\t\t\tresolve({\r\n\t\t\t\torigin: 'server',\r\n\t\t\t\tversion: data.version\r\n\t\t\t})\r\n\t\t})\r\n\t\t.fail(err => reject(err))\r\n\t})]\r\n\tif (localStorage['mydrafts']) {\r\n\t\tlet myDrafts = null\r\n\t\ttry {\r\n\t\t\tmyDrafts = JSON.parse(localStorage['mydrafts'])\r\n\t\t\tcatalog.myDraftsRaw = _.cloneDeep(myDrafts.chans)\r\n\t\t}\r\n\t\tcatch(e) {\r\n\t\t\tlocalStorage.removeItem('mydrafts')\r\n\t\t\tconsole.error(e)\r\n\t\t}\r\n\t\tif (myDrafts.chans) {\r\n\t\t\tfetchPromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\tlet myDraftsValid = []\r\n\t\t\t\tmyDrafts.chans.forEach(draft => {\r\n\t\t\t\t\tif (draft.name && draft.url && draft.id && draft.id.match(/^[a-z\\-_0-9]+$/)) {\r\n\t\t\t\t\t\tdraft.originalID = draft.id\r\n\t\t\t\t\t\tdraft.id += `!draft`\r\n\t\t\t\t\t\tmyDraftsValid.push(draft)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\terrorBoy.pushError(`Черновик #${draft.id} не добавлен в каталог: недостаточно данных или некорректный ID.`)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tcatalog.add(myDraftsValid, 'drafts')\r\n\t\t\t\tresolve({\r\n\t\t\t\t\torigin: 'drafts',\r\n\t\t\t\t\tversion: myDrafts.version\r\n\t\t\t\t})\r\n\t\t\t}))\r\n\t\t}\r\n\t}\r\n\tPromise.all(fetchPromises).then(list.init.bind(list), err => console.error(err))\r\n\r\n\t$('.tab').click(function(ev) {\r\n\t\tlet $chev = $(this).parent().find('.icon')\r\n\t\tif ($chev.css('display') === 'block' && $chev.css('opacity') == 1) {\r\n\t\t\tev.stopPropagation()\r\n\t\t\t$('#catalog header').addClass('tab-selecting')\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet tab = $(this).text().toLowerCase()\r\n\t\t\tswitchTab(tab)\r\n\t\t}\r\n\t})\r\n\r\n\tlet ctab = localStorage['cat-tab']\r\n\tif (ctab) {\r\n\t\tswitchTab(ctab)\r\n\t}\r\n\r\n\t$('#toggle-search').click(function() {\r\n\t\t$('#catalog').addClass('searching')\r\n\t\t$('#search').focus()\r\n\t})\r\n\t$('#search').on('input', function() {\r\n\t\tlet val = $(this).val().trim().toLowerCase()\r\n\t\t$('#catalog').toggleClass('search-filter', !!val.length)\r\n\t\tinjector.inject('cat-search', `.search-filter .cat-chan[data-search *= \"${val}\"] {display: inline-block}`)\r\n\t})\r\n\t$('#cancel-search').click(function() {\r\n\t\t$('#catalog').removeClass('searching search-filter')\r\n\t\t$('#search').val('')\r\n\t})\r\n\r\n\t$('body')\r\n\t.click(() => $('#catalog header').removeClass('tab-selecting'))\r\n\t.on('click', '.cc-install', function() {\r\n\t\tlet $ch = $(this).parents('.cat-chan')\r\n\t\tlist.toggle($ch[0]._libdata)\r\n\t})\r\n\t.on('click', '.make-embed', function() {\r\n\t\t$(this).parents('.cat-chan').toggleClass('code-on')\r\n\t})\r\n\t.on('dragenter dragend dragover drop dragleave', function(ev) {\r\n\t\tev.preventDefault()\r\n\t\tev.stopPropagation()\r\n\t})\r\n\t.on('drop', ev => handleFile(ev.originalEvent))\r\n\r\n\t$('#up-victim').on('change', ev => handleFile(ev.originalEvent))\r\n\t$('#import-draft').click(() => $('#up-victim').click())\r\n}\r\n\r\nfunction switchTab(tab) {\r\n\t$('.tab').removeClass('tab-selected')\r\n\t$(jq`#tab-${tab}`).addClass('tab-selected')\r\n\t$('#catalog').removeClass('tab-default tab-custom tab-drafts').addClass(`tab-${tab}`)\r\n\tlocalStorage['cat-tab'] = tab\r\n}\r\n\r\n/*function displayErrorToggle(text) {\r\n\t$('#errmsgbox').fadeToggle('fast').find('.error-message').text(text || '')\r\n}*/\r\n\r\nvar errorBoy = {\r\n\tpushError: function(msg) {\r\n\t\t$('#error-wrapper').append(html`<div class=\"errmsgbox\" onclick=\"this.remove()\">\r\n\t\t\t<svg id=\"close-errmsg\" class=\"icon\"><use xlink:href=\"#i-x\"></use></svg>\r\n\t\t\t<p class=\"error-message\">${_.escape(msg)}</p>\r\n\t\t</div>`)\r\n\t}\r\n}\r\n\r\nvar list = {\r\n\tinit: function(vers) {\r\n\t\tlet versMap = {}\r\n\t\tvers.forEach(v => versMap[v.origin] = v.origin)\r\n\t\tthis.versions = versMap\r\n\t\tlocalStorage['catalogVersions'] = JSON.stringify(versMap)\r\n\r\n\t\tthis.sortable = Sortable.create(document.querySelector('#boardlist'), {\r\n\t\t\thandle: '.dragger',\r\n\t\t\tanimation: 150,\r\n\t\t\tonSort: this.sync.bind(this)\r\n\t\t})\r\n\t\t\r\n\t\tlet myList = localStorage['myChans_new']\r\n\t\t, myListUpdated = []\r\n\t\tif (myList) {\r\n\t\t\ttry {\r\n\t\t\t\tmyList = JSON.parse(myList)\r\n\t\t\t}\r\n\t\t\tcatch(e) {\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t\tlocalStorage.removeItem('myChans_new')\r\n\t\t\t\tmyList = null\r\n\t\t\t}\r\n\t\t\tif (myList && myList.length) {\r\n\t\t\t\tmyList.forEach(ich => {\r\n\t\t\t\t\tlet actual = catalog.chanByID(ich.id)\r\n\t\t\t\t\tif (actual) {\r\n\t\t\t\t\t\tmyListUpdated.push(actual)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!myList) {\r\n\t\t\t$('.included-chan').each(function() {\r\n\t\t\t\tmyListUpdated.push(this._libdata)\r\n\t\t\t})\r\n\t\t}\r\n\t\tthis.add(myListUpdated)\r\n\t},\r\n\tadd: function(chans) {\r\n\t\tarrayify(chans).forEach(chan => {\r\n\t\t\t['catbg', 'offset'/*, 'included'*/].forEach(prop => delete chan[prop])\r\n\t\t\tlet $ch = $(this.buildChan(chan))\r\n\t\t\t$ch[0]._libdata = chan\r\n\t\t\t$('#boardlist').append($ch)\r\n\t\t\t$(jq`#cat_${chan.id}`).addClass('installed')\r\n\t\t})\r\n\t\tthis.sync()\r\n\t},\r\n\tbuildChan: function(chan) {\r\n\t\tlet name = _.escape(chan.name)\r\n\t\t, ballSrc = chan.ball || html`/chans/balls/${chan.section}/${chan.section == 'drafts' ? 'no-ball' : chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}`\r\n\t\treturn html`<li class=\"list-chan\" id=\"installed_${chan.id}\" data-id=\"${chan.id}\">\r\n\t\t\t<img src=\"${ballSrc}\" class=\"list-chanball\">\r\n\t\t\t<div class=\"dragger\"><svg class=\"icon\"><use xlink:href=\"#i-drag\"></use></div>\r\n\t\t\t<div class=\"list-chan-title\">${name || 'Без имени'}</div>\r\n\t\t\t<div class=\"delete-chan\" onclick=\"javascript:list.remove('${chan.id}')\"><svg class=\"icon\"><use xlink:href=\"#i-x\"></use></div>\r\n\t\t</li>`\r\n\t},\r\n\ttoggle: function(chan) {\r\n\t\tif (_.includes(this.sortable.toArray(), chan.id)) {\r\n\t\t\tthis.remove(chan.id)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.add(chan)\r\n\t\t}\r\n\t},\r\n\tremove: function(id) {\r\n\t\t$(jq`#installed_${id}`).remove()\r\n\t\t$(jq`#cat_${id}`).removeClass('installed')\r\n\t\tthis.sync()\r\n\t},\r\n\tsync: function() {\r\n\t\tlet res = []\r\n\t\tdocument.querySelectorAll('.list-chan').forEach(ch => {\r\n\t\t\tres.push(ch._libdata)\r\n\t\t})\r\n\t\tlocalStorage.removeItem('compiledCSS')\r\n\t\tlocalStorage['myChans_new'] = JSON.stringify(res)\r\n\t}\r\n}\r\n\r\nvar catalog = {\r\n\tadd: function(chans, section) {\r\n\t\tarrayify(chans).forEach(chan => {\r\n\t\t\tif (!chan.section) {\r\n\t\t\t\tchan.section = section || (chan.default ? 'default' : 'custom')\r\n\t\t\t}\r\n\t\t\tchan.url = _.escape(chan.url)\r\n\t\t\tlet $ch = $(this.buildChan(chan))\r\n\t\t\t$ch[0]._libdata = chan\r\n\t\t\t$('#catalog-contents').append($ch)\r\n\t\t})\r\n\t\t$('#import-draft').insertAfter('.cat-chan:last')\r\n\t},\r\n\tbuildChan: function(chan) {\r\n\t\tlet name = _.escape(chan.name)\r\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\r\n\t\t, search = `${chan.originalID || chan.id} ${name} ${chan.url.replace(/^https?:\\/\\//, '')} ${(chan.wiki || '').replace(/^https?:\\/\\//, '')}`\r\n\t\t, ballSrc = chan.ball || `/chans/balls/${chan.section}/${chan.section == 'drafts' ? 'no-ball' : chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}`\r\n\t\treturn html`<div class=\"cat-chan sect-${chan.section} ${chan.included ? 'included-chan' : ''}\" data-search=\"${search.toLowerCase()}\" id=\"cat_${chan.id}\">\r\n\t\t\t<div class=\"cc-ball-wrap\" style=\"${makeGradient(chan.catbg)}\">\r\n\t\t\t\t<img src=\"${ballSrc}\" class=\"cc-ball\" ${chan.offset ? makeOffset(chan.offset) : ''}></img>\r\n\t\t\t\t<div class=\"channame-overlay\">\r\n\t\t\t\t\t<a href=\"${chan.url}\">${name}</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"cc-toolbar\">\r\n\t\t\t\t<button class=\"cc-install\">\r\n\t\t\t\t\t<span class=\"cci-i\">Добавить</span>\r\n\t\t\t\t\t<span class=\"cci-u\">Удалить</span>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"chan-options make-embed\" title=\"Код для кнопки\">\r\n\t\t\t\t<svg class=\"icon\">\r\n\t\t\t\t\t<use class=\"co-code\" xlink:href=\"#i-code\"></use>\r\n\t\t\t\t\t<use class=\"co-close\" xlink:href=\"#i-x\"></use>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t\t<a class=\"chan-options info-link\" target=\"_blank\" href=\"${wiki}\" title=\"Информация\">\r\n\t\t\t\t<svg class=\"icon\"><use xlink:href=\"#i-info\"></use></svg>\r\n\t\t\t</a>\r\n\t\t\t<textarea onclick=\"this.select()\">${_.escape(`<script src=\"${document.location.origin || (document.location.protocol + '//' + document.location.host)}/embed/add.js\" chan=\"${chan.id}\"></script>`)}</textarea>\r\n\t\t</div>`\r\n\t},\r\n\tchanByID: id => {\r\n\t\tlet ch = document.querySelector(jq`#cat_${id}`)\r\n\t\tif (ch && ch._libdata) {\r\n\t\t\treturn ch._libdata\r\n\t\t}\r\n\t\telse return null\r\n\t},\r\n\tmyDraftsRaw: [],\r\n\tsyncRawDrafts: function() {\r\n\t\tlocalStorage['mydrafts'] = JSON.stringify({\r\n\t\t\tversion: new Date().getTime(),\r\n\t\t\tchans: this.myDraftsRaw\r\n\t\t})\r\n\t}\r\n}\r\n\r\nfunction arrayify(arr) {\r\n\treturn (arr instanceof Array) ? arr : [arr]\r\n}\r\n\r\nvar injector = {\r\n\tinject: function(alias, css) {\r\n\t\tvar id = `injector:${alias}`\r\n\t\tvar existing = document.getElementById(id)\r\n\t\tif (existing) {\r\n\t\t\texisting.innerHTML = css\r\n\t\t\treturn\r\n\t\t}\r\n\t\tvar head = document.head || document.getElementsByTagName('head')[0]\r\n\t\t, style = document.createElement('style');\r\n\t\tstyle.type = 'text/css'\r\n\t\tstyle.id = id\r\n\t\tif (style.styleSheet) {\r\n\t\t\tstyle.styleSheet.cssText = css\r\n\t\t} else {\r\n\t\t\tstyle.appendChild(document.createTextNode(css))\r\n\t\t}\r\n\t\thead.appendChild(style)\r\n\t},\r\n\tremove: function(alias) {\r\n\t\tvar id = `injector:${alias}`\r\n\t\tvar style = document.getElementById(id)\r\n\t\tif (style) {\r\n\t\t\tvar head = document.head || document.getElementsByTagName('head')[0]\r\n\t\t\tif (head)\r\n\t\t\t\thead.removeChild(document.getElementById(id))\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction makeGradient(colors) {\r\n\tlet unprefixed = `linear-gradient(to bottom, #${colors[0]} 0%, #${colors[1]} 100%)`\r\n\t, res = /(((?:radial|linear)-gradient)\\((?:(ellipse) at center|(-?[0-9]+)deg|to (right|bottom)), ?(.+)\\));?/i.exec(unprefixed);\r\n\tif (res === null) return 'background:' + unprefixed;\r\n\tres = _.rest(_.without(res, undefined));\r\n\tvar ret = res[0]+'; ';\r\n\tvar gradientType = res[1];\r\n\tvar gradientDirection;\r\n\tif (!isNaN(res[2])) gradientDirection = (90 - parseFloat(res[2])) + 'deg, ';\r\n\telse if (res[2] == 'bottom') gradientDirection = 'top, ';\r\n\telse if (res[2] == 'right') gradientDirection = 'left, ';\r\n\telse gradientDirection = 'center, ellipse cover, ';\r\n\tvar gradientStops = res[3];\r\n\t_.each(['-o-', '-webkit-', '-moz-'], function(prefix) {\r\n\t\tret += 'background:' + prefix + gradientType + '(' + gradientDirection + gradientStops + '); ';\r\n\t});\r\n\treturn 'background:' + ret;\r\n}\r\n\r\nfunction makeOffset(offset) {\r\n\tlet left = offset[0], top = offset[1]\r\n\t, ret = ''\r\n\tif (left == 0 && top == 0) {\r\n\t\treturn ret\r\n\t}\r\n\t;['', '-webkit-', '-ms-', '-moz-', '-o-'].forEach(prefix => {\r\n\t\tret += `${prefix}transform: translate(${left}px, ${top}px); `\r\n\t})\r\n\treturn `style=\"${ret}\"`\r\n}\r\n\r\nNodeList.prototype.forEach = Array.prototype.forEach;\r\n\r\n// Produces a function which applies fn() to all values\r\nfunction makeEscapeTagLiteralFn(fn) {\r\n  return function(strings, ...values) {\r\n    let result = \"\"\r\n    for (let i = 0; i < strings.length; i++) {\r\n      result += strings[i]\r\n      if (i < values.length) {\r\n        result += fn(values[i])\r\n      }\r\n    }\r\n    return result\r\n  }\r\n}\r\n// Escape tag literal functions for jQuery queries and regular expressions\r\nvar jq = makeEscapeTagLiteralFn(v => v.replace(/([!\"#$%&'()*+,\\-./:;<=>?@[\\\\\\]^`{|}~ ])/g, \"\\\\$1\"))\r\n\r\nvar conf = {\r\n\twiki: 'http://wiki.1chan.ca/'\r\n}\r\n\r\nfunction reloadFrame() {\r\n\tparent.frames.list.document.location.reload()\r\n\tparent.openMenu()\r\n}\r\n\r\nwindow.addEventListener(\"message\", () => {\r\n\tparent.frames.live.document.location.reload()\r\n}, false)\r\n\r\nfunction handleFile(ev) {\r\n\tlet files = (ev.type == \"drop\") ? ev.dataTransfer.files : ev.target.files\r\n\t, f = files[0]\r\n\r\n\tif (f) {\r\n\t\tvar reader = new FileReader()\r\n\t\t\r\n\t\treader.onload = (function() {\r\n\t\t\treturn (function(e) {\r\n\t\t\t\tlet imported = null\r\n\t\t\t\ttry {\r\n\t\t\t\t\timported = JSON.parse(e.target.result)\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\terrorBoy.pushError('Не удалось разобрать JSON')\r\n\t\t\t\t}\r\n\t\t\t\tif (imported) {\r\n\t\t\t\t\tif (!(imported.name && imported.url && imported.id && imported.id.match(/^[a-z\\-_0-9]+$/))) {\r\n\t\t\t\t\t\terrorBoy.pushError('Невозможно добавить черновик. Недостаточно данных.')\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_.find(catalog.myDraftsRaw, {id: imported.id})) {\r\n\t\t\t\t\t\terrorBoy.pushError('Черновик с таким id уже существует')\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatalog.myDraftsRaw.push(_.cloneDeep(imported))\r\n\t\t\t\t\tcatalog.syncRawDrafts()\r\n\t\t\t\t\timported.id += `!draft`\r\n\t\t\t\t\tcatalog.add(imported, 'drafts')\r\n\t\t\t\t}\r\n\t\t\t}).bind(this)\r\n\t\t}).bind(this)(f)\r\n\r\n\t\treader.readAsText(f)\r\n\t}\r\n}\r\n\r\nconsole.info('Я не на ангуляре. Не на ангуляре.')"]}