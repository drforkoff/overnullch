'use strict';function main(){if(location.search){var _url=/url=([^&]+)/.exec(location.search),_description=/description=([^&]+)/.exec(location.search);_url&&(_url=decodeURIComponent(_url[1]),$('#url').val(_url)),_description&&(_description=decodeURIComponent(_description[1]),$('#description').val(_description))}$.ajaxSetup({dataType:'json'}),$('#closer').click(parent.toggleShare),$('form').on('submit',function(ev){ev.preventDefault(),$(this).addClass('busy'),$.post('api.php',{url:$('#url').val(),description:$('#description').val()}).done(handleResponse.bind(this))}),$('#error-wrapper').click(function(){return $('form').removeClass('error')})}function handleResponse(data){if($('form').removeClass('busy'),data.error){var err=data.error;$('form').addClass('error'),$('#errorbox').text('string'==typeof err?errorDescriptors[err]||err:errorDescriptors.hasOwnProperty(err.errtype)?errorDescriptors[err.errtype](err.errdata):err.errtype+' ('+err.errdata+')')}else{var inFrame=!1;parent._frames&&parent.frames.list&&parent.frames.live&&(parent.frames.list.live.build(data.data),parent.frames.list.live.toggle(!0),'horizontal'==parent._frames.layout&&parent.frames.list.menu.open(),inFrame=!0),$('form').addClass('success'),setTimeout(function(){inFrame&&parent.$('#live').removeClass('shown'),$('input').val('')},1500),setTimeout(function(){$('form').removeClass('success')},2e3)}}var errorDescriptors={"no-data-provided":'\u041D\u0435\u0434\u043E\u0441\u0442\u0430\u0442\u043E\u0447\u043D\u043E \u0434\u0430\u043D\u043D\u044B\u0445',"url-too-long":'\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0434\u043B\u0438\u043D\u043D\u044B\u0439 URL',"description-too-long":'\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0434\u043B\u0438\u043D\u043D\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435',"description-too-short":'\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u043A\u043E\u0440\u043E\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435',"bad-url":'\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 SQL',"url-exists":'\u0414\u0430\u043D\u043D\u0430\u044F \u0441\u0441\u044B\u043B\u043A\u0430 \u0443\u0436\u0435 \u043F\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0441\u043F\u0438\u0441\u043A\u0435',timeout:function timeout(secs){return'\u0422\u0430\u0439\u043C\u0430\u0443\u0442 '+secs+' \u0441\u0435\u043A.'},"sql-error":'\u041E\u0448\u0438\u0431\u043A\u0430 SQL'};
//# sourceMappingURL=live.js.map