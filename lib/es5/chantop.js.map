{"version":3,"sources":["../../babel/src/chantop.js"],"names":["chanTop","vstep","init","$el","list","addClass","empty","chans","load","makeCSS","count","css","_","range","forEach","p","props","has3d","prefix","injector","inject","length","chan","$","buildChan","find","click","installer","toggle","id","append","API","getRates","upd","setInterval","Date","getTime","lastUpdated","interval","is","stahp","clearInterval","updateRatings","data","oldIDs","map","newIDs","difference","document","location","reload","rating","text","arrange","isInstalled","xPlus","addRemove","name","escape","wiki","match","conf","html","section","_id","ballv","url","sortByOrder","i","attr","arranged","hov","order","oldRating","deltaClass","delta","removeClass","setTimeout","mockRandOrder","rand","Math","random","round","request","getChallenge","captcha","code","vote","lr","handleError","v","act","method","toSend","ajax","type","done","error","handleData","fail","e","hasOwnProperty","rates","Masher","setNewChallenge","challengers","console","log","debug","er","specialErrors","enter_captcha","updateCaptcha","wrong_captcha","force_reload","val","focus","ev","stopPropagation","pool","gradient","catbg","split","pair","left","right","colors","unprefixed","res","exec","rest","without","gradientDirection","ret","gradientType","isNaN","parseFloat","gradientStops","each","main","ajaxSetup","dataType","getJSON","version","initAll","err","default","window","width","unexpand","hasClass","toggleClass","scrollTop","submit","preventDefault","keydown","keyCode","installed","versions","LSfetchJSON","server","myChans","found","mych","push","filter","sync","withVersions","localStorage","JSON","stringify","chid","indicate","xp","ar","install","toInstall","uninstall","removed","remove","alias","existing","getElementById","innerHTML","head","getElementsByTagName","style","createElement","styleSheet","cssText","appendChild","createTextNode","removeChild","getComputedStyle","el","transforms","t","body","insertBefore","getPropertyValue","key","parse","removeItem"],"mappings":"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","file":"chantop.js","sourcesContent":["'use strict';\r\n\r\nvar chanTop = {\r\n\tvstep: 50,\r\n\tinit: function($el, list) {\r\n\t\tthis.$el = $el.addClass('chantop')\r\n\t\tthis.$el.empty()\r\n\t\tthis.chans = list\r\n\t\tthis.load()\r\n\t},\r\n\tmakeCSS: function(count) {\r\n\t\tvar css = '', vstep = this.vstep\r\n\t\t_.range(count).forEach(function(p) {\r\n\t\t\tvar props = ''\r\n\t\t\tif(has3d) {\r\n\t\t\t\t['', '-webkit-'].forEach(function(prefix) {\r\n\t\t\t\t\tprops += `${prefix}transform: translate3d(0, ${vstep*p}px, 0);\\n`\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tprops += `top: ${vstep*p + 10}px;`\r\n\t\t\tcss += `#co-${p} {\\n${props}}\\n`\r\n\t\t})\r\n\t\tcss += `.chantop { height: ${count*vstep}px }`\r\n\t\tinjector.inject('chantop-positions', css)\r\n\t},\r\n\tload: function() {\r\n\t\tthis.makeCSS(this.chans.length)\r\n\t\tthis.chans.forEach(chan => {\r\n\t\t\tchan.$el = $(this.buildChan(chan))\r\n\t\t\tchan.$el.find('.adder-remover').click(() => {\r\n\t\t\t\tinstaller.toggle(chan.id)\r\n\t\t\t})\r\n\t\t\tthis.$el.append(chan.$el)\r\n\t\t})\r\n\t\tAPI.getRates()\r\n\t\tthis.upd = setInterval(() => {\r\n\t\t\tif(new Date().getTime() - this.lastUpdated > this.interval/2 \r\n\t\t\t&& !$('#chantop').is(':hover') \r\n\t\t\t&& $('#chantop').css('visibility') !== 'hidden')\r\n\t\t\t\tAPI.getRates()\r\n\t\t}, this.interval)\r\n\t},\r\n\tstahp: function() {\r\n\t\tclearInterval(this.upd)\r\n\t},\r\n\tupdateRatings: function(data) {\r\n\t\tthis.lastUpdated = new Date().getTime()\r\n\t\tlet oldIDs = _.map(this.chans, 'id')\r\n\t\t, newIDs = _.map(data, 'id')\r\n\t\tif (newIDs.length !== oldIDs.length || _.difference(oldIDs, newIDs).length) {\r\n\t\t\tdocument.location.reload()\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.chans.forEach(chan => {\r\n\t\t\tchan.rating = +_.find(data, {id: chan.id}).rating\r\n\t\t\tchan.$el.find('.chan-rating').text(chan.rating)\r\n\t\t})\r\n\t\tthis.arrange()\r\n\t},\r\n\tinterval: 5000,\r\n\tbuildChan: function(chan) {\r\n\t\tlet isInstalled = installer.isInstalled(chan.id)\r\n\t\t, xPlus = isInstalled ? '×' : '+'\r\n\t\t, addRemove = isInstalled ? 'Удалить' : 'Добавить'\r\n\t\t, name = _.escape(chan.name)\r\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\r\n\t\treturn html`<div class=\"ct-chan\">\r\n\t\t\t<img src=\"/chans/balls/${chan.section}/${chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}\" alt=\"${name}\" class=\"chan-avatar\">\r\n\t\t\t<div class=\"catc-addremove adder-remover\" title=\"${addRemove}\">${xPlus}</div>\r\n\t\t\t<a href=\"${_.escape(chan.url)}\" target=\"_blank\" class=\"chan-name\"><span>${name}</span></a>\r\n\t\t\t<div class=\"chan-rating\">${chan.rating}</div>\r\n\t\t\t<div class=\"chan-rating-delta\"></div>\r\n\t\t\t<a target=\"_blank\" href=\"${wiki}\" class=\"catc-info\" title=\"Информация\">i</a>\r\n\t\t</div>`\r\n\t},\r\n\tarrange: function() {\r\n\t\t_.sortByOrder(chanTop.chans, ['rating', 'name'], ['desc', 'asc'])\r\n\t\t.forEach((chan, i) => {\r\n\t\t\tchan.$el.attr('id', `co-${i}`)\r\n\t\t\tif(this.arranged) {\r\n\t\t\t\tvar hov = ' hovering'\r\n\t\t\t\tif(i < chan.order)\r\n\t\t\t\t\thov += ' going-up'\r\n\t\t\t\telse if(i > chan.order)\r\n\t\t\t\t\thov += ' going-down'\r\n\t\t\t\telse\r\n\t\t\t\t\thov = ''\r\n\t\t\t\tif(chan.rating !== chan.oldRating) {\r\n\t\t\t\t\tvar delta = chan.rating - chan.oldRating\r\n\t\t\t\t\t, deltaClass\r\n\t\t\t\t\tif(delta > 0) {\r\n\t\t\t\t\t\tdeltaClass = 'plus'\r\n\t\t\t\t\t\tdelta= '+'+delta\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse \r\n\t\t\t\t\t\tdeltaClass = 'minus'\r\n\t\t\t\t\tchan.$el.find('.chan-rating-delta').text(`${delta}`)\r\n\t\t\t\t\t.removeClass('plus minus').addClass(deltaClass)\r\n\t\t\t\t}\r\n\t\t\t\tchan.$el.addClass(hov+(delta ? ' delta-show' : ''))\r\n\t\t\t\tsetTimeout(() => chan.$el.removeClass('hovering going-down going-up delta-show'), 1000)\r\n\t\t\t}\r\n\t\t\tchan.order = i\r\n\t\t\tchan.oldRating = chan.rating\r\n\t\t})\r\n\t\tthis.arranged = true\r\n\t},\r\n\tarranged: false,\r\n\tmockRandOrder: function(rand) {\r\n\t\trand = rand || 0.3\r\n\t\tthis.chans.forEach(chan => {\r\n\t\t\tif(Math.random() < rand) {\r\n\t\t\t\tchan.rating = Math.round(Math.random() * 1000)\r\n\t\t\t\tchan.$el.find('.chan-rating').text(`${chan.rating}`)\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.arrange()\r\n\t}\r\n}\r\n\r\nvar API = {\r\n\tgetRates: function() {\r\n\t\tthis.request('rates')\r\n\t},\r\n\tgetChallenge: function() {\r\n\t\tthis.request('challenge')\r\n\t},\r\n\tcaptcha: function(code) {\r\n\t\tthis.request('captcha', 'POST', {captcha: code})\r\n\t},\r\n\tvote: function(lr) {\r\n\t\tif(lr !== 'left' && lr !== 'right')\r\n\t\t\tthis.handleError('You can only vote Left or Right')\r\n\t\tthis.request('vote', 'POST', {v: lr})\r\n\t},\r\n\trequest: function(act, method, toSend) {\r\n\t\t$.ajax({\r\n\t\t\turl: `api.php?act=${act}`,\r\n\t\t\ttype: method || 'GET',\r\n\t\t\tdata: toSend || null,\r\n\t\t}).done(data => {\r\n\t\t\tif(data.error)\r\n\t\t\t\treturn this.handleError(data.error)\r\n\t\t\tthis.handleData(data.data)\r\n\t\t})\r\n\t\t.fail(e => this.handleError('XHR error: ', e))\r\n\t},\r\n\thandleData: function(data) {\r\n\t\tif(data.hasOwnProperty('vote_success')) {\r\n\t\t\t$('body').removeClass('enter-captcha')\r\n\t\t}\r\n\t\tif(data.hasOwnProperty('rates'))\r\n\t\t\tchanTop.updateRatings(data.rates)\r\n\t\tif(data.hasOwnProperty('challengers'))\r\n\t\t\tMasher.setNewChallenge(data.challengers)\r\n\t\tif(data.hasOwnProperty('debug'))\r\n\t\t\tconsole.log(data.debug)\r\n\t},\r\n\thandleError: function(er) {\r\n\t\tif(this.specialErrors.hasOwnProperty(er))\r\n\t\t\tthis.specialErrors[er]()\r\n\t\telse\r\n\t\t\tconsole.error(er)\r\n\t\treturn false\r\n\t},\r\n\tspecialErrors: {\r\n\t\tenter_captcha: function() {\r\n\t\t\t$('body').addClass('enter-captcha')\r\n\t\t\tupdateCaptcha()\r\n\t\t},\r\n\t\twrong_captcha: function() {\r\n\t\t\t$('#captcha-panel').addClass('wrong')\r\n\t\t\tsetTimeout(() => $('#captcha-panel').removeClass('wrong'), 1000)\r\n\t\t\tupdateCaptcha()\r\n\t\t},\r\n\t\tforce_reload: () => document.location.reload()\r\n\t}\r\n}\r\n\r\nfunction updateCaptcha() {\r\n\t$('#cpanel-wrap img').attr('src', '/captcha.php?color=200,200,200')\r\n\t$('input[name=captcha]').val('').focus()\r\n}\r\n\r\nvar Masher = {\r\n\tinit: function($el, list) {\r\n\t\tthis.$el = $el\r\n\t\tvar css = ''\r\n\t\tlist.forEach(chan => {\r\n\t\t\tvar $el = $(this.buildChan(chan))\r\n\t\t\t$el.find('a, .chan-options').click(ev => {\r\n\t\t\t\tev.stopPropagation()\r\n\t\t\t})\r\n\t\t\t$el.find('.adder-remover').click(() => {\r\n\t\t\t\tinstaller.toggle(chan.id)\r\n\t\t\t})\r\n\t\t\tthis.pool[chan.id] = $el\r\n\t\t\tcss += `\\n#ch_${chan.id} {\\n ${this.gradient(chan.catbg)} \\n}`\r\n\t\t})\r\n\t\tinjector.inject('catalog-gradients', css)\r\n\t\t$('.challenger').click(function() {\r\n\t\t\t$('.catalog-chan').addClass('post')\r\n\t\t\tAPI.vote($(this).attr('id').split('c-')[1])\r\n\t\t})\r\n\t\tAPI.getChallenge()\r\n\t},\r\n\tpool: {},\r\n\tbuildChan: chan => {\r\n\t\tlet isInstalled = installer.isInstalled(chan.id)\r\n\t\t, xPlus = isInstalled ? '×' : '+'\r\n\t\t, addRemove = isInstalled ? 'Удалить' : 'Добавить'\r\n\t\t, name = _.escape(chan.name)\r\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\r\n\t\treturn html`<div class=\"catalog-chan\">\r\n\t\t  <div class=\"cc-ball-wrap\" id=\"ch_${chan.id}\">\r\n\t\t    <img src=\"/chans/balls/${chan.section}/${chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}\" alt=\"${name}\" class=\"cc-ball\">\r\n\t\t    <a href=\"${_.escape(chan.url)}\" target=\"_blank\" class=\"channame-overlay\">${name}</a>\r\n\t\t    <div class=\"chan-options co-add adder-remover\" title=\"${addRemove}\">${xPlus}</div>\r\n\t\t    <a href=\"${wiki}\" target=\"_blank\" class=\"chan-options co-info\" title=\"Информация\">i</a>\r\n\t\t  </div>\r\n\t\t</div>`\r\n\t},\r\n\tsetNewChallenge: function(pair) {\r\n\t\tvar [left, right] = pair.map(lr => lr = this.pool[lr.id].addClass('pre').removeClass('post'))\r\n\t\t$('#c-left').append(left)\r\n\t\t$('#c-right').append(right)\r\n\t\tsetTimeout(() => {\r\n\t\t\t$('.challenger .catalog-chan').removeClass('pre')\r\n\t\t}, 500)\r\n\t},\r\n\tgradient: function(colors) {\r\n\t\tlet unprefixed = `linear-gradient(to bottom, #${colors[0]} 0%, #${colors[1]} 100%)`\r\n\t\t, res = /(((?:radial|linear)-gradient)\\((?:(ellipse) at center|(-?[0-9]+)deg|to (right|bottom)), ?(.+)\\));?/i.exec(unprefixed);\r\n\t\tif (res === null) return 'background:' + unprefixed;\r\n\t\tres = _.rest(_.without(res, undefined));\r\n\t\tvar ret = res[0]+'; ';\r\n\t\tvar gradientType = res[1];\r\n\t\tvar gradientDirection;\r\n\t\tif (!isNaN(res[2])) gradientDirection = (90 - parseFloat(res[2])) + 'deg, ';\r\n\t\telse if (res[2] == 'bottom') gradientDirection = 'top, ';\r\n\t\telse if (res[2] == 'right') gradientDirection = 'left, ';\r\n\t\telse gradientDirection = 'center, ellipse cover, ';\r\n\t\tvar gradientStops = res[3];\r\n\t\t_.each(['-o-', '-webkit-', '-moz-'], function(prefix) {\r\n\t\t\tret += 'background:' + prefix + gradientType + '(' + gradientDirection + gradientStops + '); ';\r\n\t\t});\r\n\t\treturn 'background:' + ret;\r\n\t}\r\n}\r\n\r\nfunction main() {\r\n\t$.ajaxSetup({\r\n\t\tdataType: 'json'\r\n\t})\r\n\r\n\t$.getJSON(`/chans/chans.json?v=${new Date().getTime()}`)\r\n\t.done(data => {\r\n\t\tif (data.chans && data.version) {\r\n\t\t\tinitAll(data.chans, data.version)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.error('bad-json')\r\n\t\t}\r\n\t})\r\n\t.fail(err => console.error(err))\r\n\r\n\thas3d = has3d()\r\n}\r\n\r\nfunction initAll(chans, version) {\r\n\tchans.forEach(chan => {\r\n\t\tchan.section = chan.default ? 'default' : 'custom'\r\n\t})\t\r\n\tinstaller.init(chans, version)\r\n\tchanTop.init($('#chantop'), chans)\r\n\tMasher.init($('#battleground'), chans)\r\n\r\n\t$('header').click(() => {\r\n\t\tif($(window).width() <= 640) {\r\n\t\t\tvar unexpand = $('body').hasClass('xpnd')\r\n\t\t\t$('body').toggleClass('xpnd')\r\n\t\t\tif(!unexpand)\r\n\t\t\t\t$('#battleground-wrap').scrollTop(0)\r\n\t\t}\r\n\t})\r\n\t$('#cpanel-wrap img').click(updateCaptcha)\r\n\t$('#captcha-panel').submit(ev => {\r\n\t\tev.preventDefault()\r\n\t\tAPI.captcha($('input[name=captcha]').val())\r\n\t})\r\n\t$(window).keydown(function(ev) {\r\n\t\tif($('body').hasClass('enter-captcha'))\r\n\t\t\treturn\r\n\t\tif(ev.keyCode == 37 || ev.keyCode == 65)\r\n\t\t\tAPI.vote('left')\r\n\t\tif(ev.keyCode == 39 || ev.keyCode == 68)\r\n\t\t\tAPI.vote('right')\r\n\t})\r\n}\r\n\r\nvar installer = {\r\n\tinstalled: [],\r\n\tinit: function(list, version) {\r\n\t\tthis.list = list\r\n\t\tthis.versions = LSfetchJSON('catalogVersions') || {}\r\n\t\tthis.versions.server = version\r\n\t\tlet myChans = LSfetchJSON('myChans_new')\r\n\t\t, freshList = []\r\n\t\tif (myChans && myChans.length) {\r\n\t\t\tmyChans.forEach(mych => {\r\n\t\t\t\tlet found = _.find(list, {id: mych.id})\r\n\t\t\t\tthis.installed.push(found || mych)\r\n\t\t\t})\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.installed = _.filter(list, {'included': true})\r\n\t\t}\r\n\t\tthis.sync(true)\r\n\t},\r\n\tsync: function(withVersions) {\r\n\t\tlocalStorage['myChans_new'] = JSON.stringify(this.installed)\r\n\t\tif (withVersions) {\r\n\t\t\tlocalStorage['catalogVersions'] = JSON.stringify(this.versions)\r\n\t\t}\r\n\t},\r\n\tisInstalled: function(chid) {\r\n\t\treturn !!_.find(this.installed, {id: chid})\r\n\t},\r\n\tindicate: function(chid, xp, ar) {\r\n\t\t[Masher.pool[chid], _.find(chanTop.chans, {id: chid}).$el].forEach($el => {\r\n\t\t\t$el.find('.adder-remover').text(xp).attr('title', ar)\r\n\t\t})\r\n\t}, \r\n\tinstall: function(chid) {\r\n\t\tlet toInstall = _.find(this.list, {id: chid})\r\n\t\tif (toInstall) {\r\n\t\t\tthis.installed.push(toInstall)\r\n\t\t\tthis.sync()\r\n\t\t\tthis.indicate(chid, '×', 'Удалить')\r\n\t\t}\r\n\t},\r\n\tuninstall: function(chid) {\r\n\t\tvar removed = _.remove(this.installed, {id: chid})\r\n\t\tif (removed) {\r\n\t\t\tthis.sync()\r\n\t\t\tthis.indicate(chid, '+', 'Добавить')\r\n\t\t}\r\n\t},\r\n\ttoggle: function(chid) {\r\n\t\tif(this.isInstalled(chid))\r\n\t\t\tthis.uninstall(chid)\r\n\t\telse\r\n\t\t\tthis.install(chid)\r\n\t}\r\n}\r\n\r\nvar conf = {\r\n\twiki: 'http://wiki.1chan.ca/'\r\n}\r\n\r\nvar injector = {\r\n  inject: function(alias, css) {\r\n    var id = `injector:${alias}`\r\n    var existing = document.getElementById(id)\r\n    if(existing) {\r\n      existing.innerHTML = css\r\n      return\r\n    }\r\n    var head = document.head || document.getElementsByTagName('head')[0]\r\n    , style = document.createElement('style');\r\n    style.type = 'text/css'\r\n    style.id = id\r\n    if (style.styleSheet) {\r\n      style.styleSheet.cssText = css\r\n    } else {\r\n      style.appendChild(document.createTextNode(css))\r\n    }\r\n    head.appendChild(style)\r\n  },\r\n  remove: function(alias) {\r\n    var id = `injector:${alias}`\r\n    var style = document.getElementById(id)\r\n    if(style) {\r\n      var head = document.head || document.getElementsByTagName('head')[0]\r\n      if(head)\r\n        head.removeChild(document.getElementById(id))\r\n    }\r\n  }\r\n}\r\n\r\nfunction has3d() {\r\n  if (!window.getComputedStyle) {\r\n    return false;\r\n  }\r\n  \r\n  var el = document.createElement('p'),\r\n  has3d,\r\n  transforms = {\r\n    'webkitTransform':'-webkit-transform',\r\n    'OTransform':'-o-transform',\r\n    'msTransform':'-ms-transform',\r\n    'MozTransform':'-moz-transform',\r\n    'transform':'transform'\r\n  };\r\n\r\n  // Add it to the body to get the computed style\r\n  document.body.insertBefore(el, null);\r\n\r\n  for(var t in transforms){\r\n    if( el.style[t] !== undefined ){\r\n      el.style[t] = 'translate3d(1px,1px,1px)';\r\n      has3d = window.getComputedStyle(el).getPropertyValue(transforms[t]);\r\n    }\r\n  }\r\n\r\n  document.body.removeChild(el);\r\n\r\n  return (has3d !== undefined && has3d.length > 0 && has3d !== \"none\");\r\n}\r\n\r\nfunction LSfetchJSON(key) {\r\n  let val = null, data = localStorage[key]\r\n  if (typeof data !== 'undefined') {\r\n    try {\r\n      val = JSON.parse(data)\r\n    }\r\n    catch(e) {\r\n      console.error(e)\r\n      localStorage.removeItem(key)\r\n    }\r\n  }\r\n  return val\r\n}"]}